---
title: "Hackathon"
format: html
editor: visual
---

```{r}
library(ggplot2)
data("iris")
iris_summary <- aggregate(cbind(Sepal.Width, Petal.Length) ~ Species, data = iris, FUN = mean)
iris_summary$NormWidth <- iris_summary$Sepal.Width / sum(iris_summary$Sepal.Width)
ggplot(iris_summary, aes(x = Species, y = Petal.Length)) +
  geom_col(aes(width = NormWidth, fill = Species)) +
  geom_text(aes(label = round(Petal.Length, 2)), vjust = -0.5, size = 4, family = "mono") +
  scale_fill_manual(values = c(setosa = "#1f77b4", versicolor = "#4fa9dc", virginica = "#a6cee3")) +
  labs(title = "Variable-Width Column Chart of Iris Species", x = "Species", y = "Average Petal Length") +
  theme_classic(base_family = "mono") +
  theme(legend.position = "none")

```
```{r}
d <- reshape(aggregate(cbind(Sepal.Width, Petal.Length) ~ Species, iris, mean),
             list(2:3), v.names = "Value", timevar = "Variable",
             times = c("Sepal.Width", "Petal.Length"), direction = "long")
ggplot(d, aes(x = Value, y = 1, fill = Variable)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = round(Value, 2)), hjust = -0.2, color = "black", size = 3.5, fontface = "bold") +
  facet_grid(Species ~ Variable, switch = "both") +
  coord_fixed(ratio = 1.3, clip = "off") +
  scale_fill_manual(values = c(Sepal.Width = "#a6cee3", Petal.Length = "#1f77b4")) +
  theme_minimal(base_family = "sans") +
  theme(panel.border = element_rect(color = "gray80", fill = NA),
        panel.spacing = unit(0.5, "lines"),
        strip.placement = "outside",
        strip.text = element_text(face = "bold", size = 11),
        axis.text = element_blank(), axis.ticks = element_blank(),
        panel.grid = element_blank(), legend.position = "none",
        plot.margin = margin(10, 30, 10, 10))

```


